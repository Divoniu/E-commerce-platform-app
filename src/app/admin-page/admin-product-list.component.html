<p-menubar>
  <ng-template pTemplate="end">
    <p-button (click)="showDialogNewProduct()" icon="pi pi-plus" label="New product"></p-button>
    <app-update-product (savedProduct)="savedProduct($event)" (updatedProduct)="updatedProduct($event)"
                        (closeEmitter)="onClose()" [selectedProduct]="selectedProduct"
                        [show]="visible" [header]="header"></app-update-product>
  </ng-template>
</p-menubar>
<app-delete-modal (deleteEmitter)="deletedProduct($event)" (closeEmitter)="onCloseDelete()"
                  [selectedProduct]="selectedProduct"
                  [deleteVisible]="deleteVisible" [header]="'Delete'"></app-delete-modal>
<p-table styleClass="p-datatable-sm" [paginator]="true" [rows]="row" [rowsPerPageOptions]="rows" [value]="productsList"
         [tableStyle]="{ 'min-width': '50rem' }" responsiveLayout="stack" [breakpoint]="'960px'"
         [globalFilterFields]="['name']">
  <ng-template pTemplate="header">
    <tr>
      <th>#</th>

      <th>Photos</th>
      <!--      <th>Image</th>-->
      <th>Name</th>
      <th>Category</th>
      <th>Stock</th>
      <th>Price</th>
      <th>Discount</th>
      <th>Final Price</th>
      <th>Action</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-product let-rowIndex="rowIndex">
    <tr class="item" [pSelectableRow]="product" [pSelectableRowIndex]="rowIndex">
      <td>{{rowIndex + 1}}</td>

      <td>
        <img alt="no image" *ngIf="product.imagesName[0]" width="50px"
             src="http://localhost:8081/api/images/download?name={{product.imagesName[0]}}"
             (error)="handleMissingImg($event)">
      </td>
      <!--      <td><img alt="image" [src]="product.images" style="max-width: 100px;max-height: 50px"></td>-->
      <td>{{ product.name }}</td>
      <td>{{ product.categoryName }}</td>
      <td>{{ product.unitsInStock }}</td>
      <td>${{ product.price }}</td>
      <td>{{ product.discountPercentage }}%</td>
      <td>${{ (product.price - ((product.price * product.discountPercentage) / 100)).toFixed(2) }}</td>
      <td>
        <div class="card flex justify-content-center justify-content-evenly">
          <p-button pTooltip="Delete" tooltipPosition="top" icon="pi pi-times" styleClass="p-button-danger p-button-sm"
                    (click)="showDialogDeleteProduct(product,$event)"></p-button>
          <p-button pTooltip="Edit" tooltipPosition="top" icon="pi pi-file-edit" styleClass="p-button-info p-button-sm"
                    (click)="showDialogEditProduct(product)"></p-button>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>
