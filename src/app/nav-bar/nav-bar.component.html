<nav class="navBar py-2 px-2" aria-label="product navigation">
  <div class="navControlsContainer">
    <img
      src="./../../assets/images/project-logo.png"
      height="40"
      class="mx-2"
      (click)="goHome()"
    />

    <div class="searchContainer">
      <input
        type="text"
        pInputText
        placeholder="Search"
        class="ml-4 searchInput"
      />
      <button class="searchButton">
        <i class="pi pi-search"></i>
      </button>
    </div>
  </div>

  <div class="navControlsContainer accountControls">
    <p-button
      label="Clear storage"
      styleClass="p-button-link"
      (click)="clearStorage()"
    ></p-button>
    <a class="navBarItem" (click)="shoppingCart.toggle($event)"
      ><i
        class="pi pi-shopping-cart"
        pBadge
        severity="danger"
        [value]="orderItems.length"
      ></i
      ><span>Basket</span></a
    >
    <!-- [value]="basketContent.length.toString()" old basket badge setting -->
    <a class="navBarItem" (click)="favoriteItems.toggle($event)"
      ><i
        class="pi pi-heart"
        pBadge
        severity="danger"
        [value]="favoriteProductsList.length.toString()"
      ></i
      ><span>Favorite</span></a
    >

    <a
      class="navBarItem"
      (click)="myAccount.toggle($event)"
      *ngIf="!isAuthenticated()"
    >
      <i class="pi pi-user"></i
      ><span style="white-space: nowrap">My Account</span></a
    >
    <a
      class="navBarItem"
      (click)="loadBasketContent()"
      *ngIf="isAuthenticated()"
      style="white-space: nowrap">load basket</a>
    <a
      class="navBarItem"
      (click)="userOptions.toggle($event)"
      *ngIf="isAuthenticated()"
    >
      <i class="pi pi-user"></i
      ><span style="white-space: nowrap">{{ userLoggedIn.username }}</span></a
    >

    <div class="flex navBarItem" *ngIf="isAuthenticated()">
      <div *ngIf="isAdmin === false">
        <p-button
          [(ngModel)]="isAdmin"
          id="adminMode"
          (click)="goToAdminPage()"
          styleClass="p-button-outlined"
          >Admin mode off</p-button
        >
      </div>
      <div *ngIf="isAdmin === true">
        <p-button [(ngModel)]="isAdmin" id="adminMode" (click)="goToAdminPage()"
          >Admin mode on</p-button
        >
      </div>
    </div>
  </div>
</nav>

<nav class="">
  <p-menubar
    #nav
    [model]="navProductControls"
    class="navControls navProductControls"
  >
  </p-menubar>
</nav>

<p-overlayPanel #userOptions>
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-button
        (click)="goToAccountDetailsPage()"
        label="Account Details"
        styleClass="p-button-text"
      ></p-button>
      <p-button
        (click)="logout()"
        label="Logout"
        styleClass="p-button-secondary p-button-text"
      ></p-button>
    </div>
  </ng-template>
</p-overlayPanel>
<p-overlayPanel #myAccount>
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-button
        (click)="goToLoginPage()"
        label="Login"
        styleClass="p-button-secondary p-button-text"
      ></p-button>

      <p-button
        label="I don't have an account"
        styleClass="p-button-link"
        (click)="register()"
      ></p-button>
      <p-button label="Forgot Password" styleClass="p-button-link"></p-button>
    </div>
  </ng-template>
</p-overlayPanel>

<p-overlayPanel #shoppingCart class="shoppingCart">
  <ng-template pTemplate="content">
    <div class="overlay">
      <h4>Last added products</h4>
      <table>
        <tr class="contentRow">
          <th>Product</th>
          <th>Qty</th>
          <th>Price</th>
        </tr>

        <tr *ngFor="let product of orderItems" class="contentRow">
          <td class="productContainer">
            <!--            <img [src]="product.images[0]" alt="product photo" />-->
            <span class="productName">{{ product.name }}</span>
          </td>

          <td>x{{ product.quantity }}</td>
          <td>${{ getItemPrice(product) }}</td>
        </tr>
      </table>
      <p-button
        (click)="goToBasketPage()"
        label="View whole basket"
        styleClass="p-button-raised"
      ></p-button>
    </div>
  </ng-template>
</p-overlayPanel>
<p-overlayPanel #favoriteItems class="favoriteItems">
  <ng-template pTemplate="content">
    <div class="overlay">
      <h4>Products you liked</h4>
      <table>
        <tr class="contentRow">
          <th>Product</th>
          <th>Qty</th>
          <th>Price</th>
        </tr>
        <tr *ngFor="let product of favoriteProductsList" class="contentRow">
          <td class="productContainer">
            <img [src]="product.productImage" alt="product photo" />
            <span class="productName">{{ product.name }}</span>
          </td>
          <td>x{{ product.unitsInStock }}</td>
          <td>${{ product.price }}</td>
        </tr>
      </table>
      <p-button label="View all" styleClass="p-button-raised"></p-button>
    </div>
  </ng-template>
</p-overlayPanel>
